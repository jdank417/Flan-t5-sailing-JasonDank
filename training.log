Loading processed dataset...
Initializing model...
Trainable parameters: 1,769,472 (0.71% of 249,347,328 total)
Starting training...
Map:   0%|          | 0/323 [00:00<?, ? examples/s]/Users/jasondank/PycharmProjects/Flan-t5-sailing/.venv/lib/python3.13/site-packages/transformers/tokenization_utils_base.py:3959: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
Map: 100%|██████████| 323/323 [00:00<00:00, 3083.86 examples/s]Map: 100%|██████████| 323/323 [00:00<00:00, 3048.32 examples/s]
/Users/jasondank/PycharmProjects/Flan-t5-sailing/models/trainer.py:116: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
  trainer = Seq2SeqTrainer(
No label_names provided for model class `PeftModelForSeq2SeqLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
Warning: fp16 mixed precision is not supported on this device. Training with fp32 instead.
Warning: Validation dataset is empty. Training without validation.
  0%|          | 0/810 [00:00<?, ?it/s]/Users/jasondank/PycharmProjects/Flan-t5-sailing/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.48.0. You should pass an instance of `EncoderDecoderCache` instead, e.g. `past_key_values=EncoderDecoderCache.from_legacy_cache(past_key_values)`.
  0%|          | 1/810 [00:02<31:34,  2.34s/it]  0%|          | 2/810 [00:03<24:56,  1.85s/it]  0%|          | 3/810 [00:05<22:47,  1.69s/it]  0%|          | 4/810 [00:06<21:53,  1.63s/it]  1%|          | 5/810 [00:08<21:29,  1.60s/it]  1%|          | 6/810 [00:09<21:00,  1.57s/it]  1%|          | 7/810 [00:11<20:33,  1.54s/it]  1%|          | 8/810 [00:12<20:16,  1.52s/it]  1%|          | 9/810 [00:14<19:58,  1.50s/it]  1%|          | 10/810 [00:15<19:47,  1.48s/it]  1%|▏         | 11/810 [00:17<19:36,  1.47s/it]  1%|▏         | 12/810 [00:18<19:34,  1.47s/it]  2%|▏         | 13/810 [00:20<19:36,  1.48s/it]  2%|▏         | 14/810 [00:21<19:51,  1.50s/it]  2%|▏         | 15/810 [00:23<19:41,  1.49s/it]  2%|▏         | 16/810 [00:24<19:31,  1.48s/it]  2%|▏         | 17/810 [00:26<19:26,  1.47s/it]  2%|▏         | 18/810 [00:27<19:21,  1.47s/it]  2%|▏         | 19/810 [00:29<19:39,  1.49s/it]  2%|▏         | 20/810 [00:30<19:42,  1.50s/it]  3%|▎         | 21/810 [00:32<19:31,  1.49s/it]  3%|▎         | 22/810 [00:33<19:19,  1.47s/it]  3%|▎         | 23/810 [00:35<19:41,  1.50s/it]  3%|▎         | 24/810 [00:36<19:39,  1.50s/it]  3%|▎         | 25/810 [00:38<19:28,  1.49s/it]  3%|▎         | 26/810 [00:39<19:14,  1.47s/it]  3%|▎         | 27/810 [00:40<19:06,  1.46s/it]  3%|▎         | 28/810 [00:42<18:59,  1.46s/it]  4%|▎         | 29/810 [00:43<18:55,  1.45s/it]  4%|▎         | 30/810 [00:45<18:51,  1.45s/it]  4%|▍         | 31/810 [00:46<18:45,  1.45s/it]  4%|▍         | 32/810 [00:48<18:44,  1.44s/it]  4%|▍         | 33/810 [00:49<18:46,  1.45s/it]  4%|▍         | 34/810 [00:51<18:45,  1.45s/it]  4%|▍         | 35/810 [00:52<18:39,  1.44s/it]  4%|▍         | 36/810 [00:53<18:34,  1.44s/it]  5%|▍         | 37/810 [00:55<18:28,  1.43s/it]  5%|▍         | 38/810 [00:56<18:22,  1.43s/it]  5%|▍         | 39/810 [00:58<18:21,  1.43s/it]  5%|▍         | 40/810 [00:59<18:25,  1.44s/it]  5%|▌         | 41/810 [01:01<18:26,  1.44s/it]  5%|▌         | 42/810 [01:02<18:27,  1.44s/it]  5%|▌         | 43/810 [01:03<18:29,  1.45s/it]  5%|▌         | 44/810 [01:05<18:23,  1.44s/it]  6%|▌         | 45/810 [01:06<18:20,  1.44s/it]  6%|▌         | 46/810 [01:08<18:20,  1.44s/it]  6%|▌         | 47/810 [01:09<18:19,  1.44s/it]  6%|▌         | 48/810 [01:11<18:16,  1.44s/it]  6%|▌         | 49/810 [01:12<18:57,  1.49s/it]  6%|▌         | 50/810 [01:14<18:54,  1.49s/it]  6%|▋         | 51/810 [01:15<18:47,  1.49s/it]  6%|▋         | 52/810 [01:17<18:44,  1.48s/it]  7%|▋         | 53/810 [01:18<19:15,  1.53s/it]  7%|▋         | 54/810 [01:20<18:57,  1.50s/it]  7%|▋         | 55/810 [01:21<18:46,  1.49s/it]  7%|▋         | 56/810 [01:23<18:41,  1.49s/it]  7%|▋         | 57/810 [01:24<18:42,  1.49s/it]  7%|▋         | 58/810 [01:26<18:32,  1.48s/it]  7%|▋         | 59/810 [01:27<18:37,  1.49s/it]  7%|▋         | 60/810 [01:29<19:04,  1.53s/it]  8%|▊         | 61/810 [01:30<18:47,  1.51s/it]  8%|▊         | 62/810 [01:32<18:36,  1.49s/it]  8%|▊         | 63/810 [01:33<18:29,  1.49s/it]  8%|▊         | 64/810 [01:35<18:19,  1.47s/it]  8%|▊         | 65/810 [01:36<18:35,  1.50s/it]  8%|▊         | 66/810 [01:38<19:53,  1.60s/it]  8%|▊         | 67/810 [01:40<19:21,  1.56s/it]  8%|▊         | 68/810 [01:41<18:53,  1.53s/it]  9%|▊         | 69/810 [01:42<18:35,  1.51s/it]  9%|▊         | 70/810 [01:44<18:24,  1.49s/it]  9%|▉         | 71/810 [01:45<18:13,  1.48s/it]  9%|▉         | 72/810 [01:47<18:38,  1.52s/it]  9%|▉         | 73/810 [01:48<18:27,  1.50s/it]  9%|▉         | 74/810 [01:50<18:18,  1.49s/it]  9%|▉         | 75/810 [01:51<18:14,  1.49s/it]  9%|▉         | 76/810 [01:53<18:09,  1.48s/it] 10%|▉         | 77/810 [01:54<18:04,  1.48s/it] 10%|▉         | 78/810 [01:56<18:01,  1.48s/it] 10%|▉         | 79/810 [01:57<18:02,  1.48s/it] 10%|▉         | 80/810 [01:59<18:02,  1.48s/it] 10%|█         | 81/810 [02:00<17:09,  1.41s/it] 10%|█         | 82/810 [02:01<17:25,  1.44s/it] 10%|█         | 83/810 [02:03<17:47,  1.47s/it] 10%|█         | 84/810 [02:05<17:55,  1.48s/it] 10%|█         | 85/810 [02:06<17:58,  1.49s/it] 11%|█         | 86/810 [02:08<18:08,  1.50s/it] 11%|█         | 87/810 [02:09<18:26,  1.53s/it] 11%|█         | 88/810 [02:11<18:11,  1.51s/it] 11%|█         | 89/810 [02:12<18:10,  1.51s/it] 11%|█         | 90/810 [02:14<18:07,  1.51s/it] 11%|█         | 91/810 [02:15<18:07,  1.51s/it] 11%|█▏        | 92/810 [02:17<18:23,  1.54s/it] 11%|█▏        | 93/810 [02:18<18:27,  1.55s/it] 12%|█▏        | 94/810 [02:20<18:15,  1.53s/it] 12%|█▏        | 95/810 [02:21<18:02,  1.51s/it] 12%|█▏        | 96/810 [02:23<18:04,  1.52s/it] 12%|█▏        | 97/810 [02:24<18:02,  1.52s/it] 12%|█▏        | 98/810 [02:26<18:02,  1.52s/it] 12%|█▏        | 99/810 [02:27<18:17,  1.54s/it] 12%|█▏        | 100/810 [02:29<19:35,  1.66s/it] 12%|█▏        | 101/810 [02:31<19:30,  1.65s/it] 13%|█▎        | 102/810 [02:33<19:16,  1.63s/it] 13%|█▎        | 103/810 [02:34<19:15,  1.63s/it] 13%|█▎        | 104/810 [02:36<19:21,  1.64s/it] 13%|█▎        | 105/810 [02:38<20:03,  1.71s/it] 13%|█▎        | 106/810 [02:40<20:37,  1.76s/it] 13%|█▎        | 107/810 [02:41<20:17,  1.73s/it] 13%|█▎        | 108/810 [02:43<19:51,  1.70s/it] 13%|█▎        | 109/810 [02:45<19:35,  1.68s/it] 14%|█▎        | 110/810 [02:46<19:23,  1.66s/it] 14%|█▎        | 111/810 [02:48<19:24,  1.67s/it] 14%|█▍        | 112/810 [02:50<20:05,  1.73s/it] 14%|█▍        | 113/810 [02:52<20:54,  1.80s/it] 14%|█▍        | 114/810 [02:54<21:28,  1.85s/it] 14%|█▍        | 115/810 [02:56<22:06,  1.91s/it] 14%|█▍        | 116/810 [02:58<23:25,  2.03s/it] 14%|█▍        | 117/810 [03:00<22:43,  1.97s/it] 15%|█▍        | 118/810 [03:02<22:18,  1.93s/it] 15%|█▍        | 119/810 [03:04<24:13,  2.10s/it] 15%|█▍        | 120/810 [03:06<24:11,  2.10s/it] 15%|█▍        | 121/810 [03:08<24:00,  2.09s/it] 15%|█▌        | 122/810 [03:11<24:48,  2.16s/it] 15%|█▌        | 123/810 [03:13<26:16,  2.29s/it] 15%|█▌        | 124/810 [03:15<25:18,  2.21s/it] 15%|█▌        | 125/810 [03:17<24:06,  2.11s/it] 16%|█▌        | 126/810 [03:19<23:49,  2.09s/it] 16%|█▌        | 127/810 [03:21<23:06,  2.03s/it] 16%|█▌        | 128/810 [03:23<22:27,  1.98s/it] 16%|█▌        | 129/810 [03:25<23:13,  2.05s/it] 16%|█▌        | 130/810 [03:27<22:42,  2.00s/it] 16%|█▌        | 131/810 [03:29<22:21,  1.97s/it] 16%|█▋        | 132/810 [03:31<22:49,  2.02s/it] 16%|█▋        | 133/810 [03:33<22:17,  1.98s/it] 17%|█▋        | 134/810 [03:35<22:31,  2.00s/it] 17%|█▋        | 135/810 [03:37<22:40,  2.02s/it] 17%|█▋        | 136/810 [03:39<22:20,  1.99s/it] 17%|█▋        | 137/810 [03:41<22:41,  2.02s/it] 17%|█▋        | 138/810 [03:43<22:06,  1.97s/it] 17%|█▋        | 139/810 [03:45<22:15,  1.99s/it] 17%|█▋        | 140/810 [03:47<22:44,  2.04s/it] 17%|█▋        | 141/810 [03:49<22:08,  1.99s/it] 18%|█▊        | 142/810 [03:51<22:23,  2.01s/it] 18%|█▊        | 143/810 [03:53<21:54,  1.97s/it] 18%|█▊        | 144/810 [03:55<21:27,  1.93s/it] 18%|█▊        | 145/810 [03:57<21:53,  1.97s/it] 18%|█▊        | 146/810 [03:59<21:27,  1.94s/it] 18%|█▊        | 147/810 [04:01<21:06,  1.91s/it] 18%|█▊        | 148/810 [04:03<21:33,  1.95s/it] 18%|█▊        | 149/810 [04:05<21:09,  1.92s/it] 19%|█▊        | 150/810 [04:06<21:08,  1.92s/it] 19%|█▊        | 151/810 [04:08<21:13,  1.93s/it] 19%|█▉        | 152/810 [04:10<20:51,  1.90s/it] 19%|█▉        | 153/810 [04:12<21:04,  1.92s/it] 19%|█▉        | 154/810 [04:14<20:52,  1.91s/it] 19%|█▉        | 155/810 [04:16<20:30,  1.88s/it] 19%|█▉        | 156/810 [04:18<20:51,  1.91s/it] 19%|█▉        | 157/810 [04:20<20:38,  1.90s/it] 20%|█▉        | 158/810 [04:22<20:16,  1.87s/it] 20%|█▉        | 159/810 [04:24<20:53,  1.93s/it] 20%|█▉        | 160/810 [04:25<20:33,  1.90s/it] 20%|█▉        | 161/810 [04:27<20:12,  1.87s/it] 20%|██        | 162/810 [04:29<19:05,  1.77s/it] 20%|██        | 163/810 [04:31<19:14,  1.78s/it] 20%|██        | 164/810 [04:32<19:11,  1.78s/it] 20%|██        | 165/810 [04:34<19:43,  1.83s/it] 20%|██        | 166/810 [04:36<19:30,  1.82s/it] 21%|██        | 167/810 [04:38<19:39,  1.83s/it] 21%|██        | 168/810 [04:40<20:21,  1.90s/it] 21%|██        | 169/810 [04:42<20:05,  1.88s/it] 21%|██        | 170/810 [04:44<19:49,  1.86s/it] 21%|██        | 171/810 [04:46<20:12,  1.90s/it] 21%|██        | 172/810 [04:47<19:58,  1.88s/it] 21%|██▏       | 173/810 [04:49<20:11,  1.90s/it] 21%|██▏       | 174/810 [04:51<19:58,  1.88s/it] 22%|██▏       | 175/810 [04:53<19:47,  1.87s/it] 22%|██▏       | 176/810 [04:55<19:45,  1.87s/it] 22%|██▏       | 177/810 [04:57<19:20,  1.83s/it] 22%|██▏       | 178/810 [04:58<18:58,  1.80s/it] 22%|██▏       | 179/810 [05:00<19:07,  1.82s/it] 22%|██▏       | 180/810 [05:02<18:51,  1.80s/it] 22%|██▏       | 181/810 [05:04<18:49,  1.80s/it] 22%|██▏       | 182/810 [05:06<19:38,  1.88s/it] 23%|██▎       | 183/810 [05:08<19:03,  1.82s/it] 23%|██▎       | 184/810 [05:09<18:39,  1.79s/it] 23%|██▎       | 185/810 [05:11<18:55,  1.82s/it] 23%|██▎       | 186/810 [05:13<18:31,  1.78s/it] 23%|██▎       | 187/810 [05:15<18:11,  1.75s/it] 23%|██▎       | 188/810 [05:16<18:29,  1.78s/it] 23%|██▎       | 189/810 [05:18<18:23,  1.78s/it] 23%|██▎       | 190/810 [05:20<18:16,  1.77s/it] 24%|██▎       | 191/810 [05:22<18:29,  1.79s/it] 24%|██▎       | 192/810 [05:24<18:08,  1.76s/it] 24%|██▍       | 193/810 [05:25<17:50,  1.74s/it] 24%|██▍       | 194/810 [05:27<18:06,  1.76s/it] 24%|██▍       | 195/810 [05:29<17:54,  1.75s/it] 24%|██▍       | 196/810 [05:30<17:37,  1.72s/it] 24%|██▍       | 197/810 [05:32<17:52,  1.75s/it] 24%|██▍       | 198/810 [05:34<17:41,  1.73s/it] 25%|██▍       | 199/810 [05:36<17:24,  1.71s/it] 25%|██▍       | 200/810 [05:37<17:43,  1.74s/it] 25%|██▍       | 201/810 [05:39<17:39,  1.74s/it] 25%|██▍       | 202/810 [05:41<17:20,  1.71s/it] 25%|██▌       | 203/810 [05:43<17:24,  1.72s/it] 25%|██▌       | 204/810 [05:44<17:27,  1.73s/it] 25%|██▌       | 205/810 [05:46<17:12,  1.71s/it] 25%|██▌       | 206/810 [05:48<17:09,  1.71s/it] 26%|██▌       | 207/810 [05:49<17:30,  1.74s/it] 26%|██▌       | 208/810 [05:51<17:26,  1.74s/it] 26%|██▌       | 209/810 [05:53<17:14,  1.72s/it] 26%|██▌       | 210/810 [05:55<17:28,  1.75s/it] 26%|██▌       | 211/810 [05:56<17:08,  1.72s/it] 26%|██▌       | 212/810 [05:58<16:56,  1.70s/it] 26%|██▋       | 213/810 [06:00<17:19,  1.74s/it] 26%|██▋       | 214/810 [06:01<17:05,  1.72s/it] 27%|██▋       | 215/810 [06:03<16:54,  1.71s/it] 27%|██▋       | 216/810 [06:05<17:19,  1.75s/it] 27%|██▋       | 217/810 [06:07<16:57,  1.72s/it] 27%|██▋       | 218/810 [06:08<16:43,  1.69s/it] 27%|██▋       | 219/810 [06:10<17:02,  1.73s/it] 27%|██▋       | 220/810 [06:12<16:46,  1.71s/it] 27%|██▋       | 221/810 [06:13<16:33,  1.69s/it] 27%|██▋       | 222/810 [06:15<16:55,  1.73s/it] 28%|██▊       | 223/810 [06:17<16:41,  1.71s/it] 28%|██▊       | 224/810 [06:19<16:28,  1.69s/it] 28%|██▊       | 225/810 [06:20<16:47,  1.72s/it] 28%|██▊       | 226/810 [06:22<16:35,  1.70s/it] 28%|██▊       | 227/810 [06:24<16:22,  1.69s/it] 28%|██▊       | 228/810 [06:25<16:36,  1.71s/it] 28%|██▊       | 229/810 [06:27<16:31,  1.71s/it] 28%|██▊       | 230/810 [06:29<16:18,  1.69s/it] 29%|██▊       | 231/810 [06:30<16:25,  1.70s/it] 29%|██▊       | 232/810 [06:32<16:26,  1.71s/it] 29%|██▉       | 233/810 [06:34<16:13,  1.69s/it] 29%|██▉       | 234/810 [06:35<16:07,  1.68s/it] 29%|██▉       | 235/810 [06:37<16:35,  1.73s/it] 29%|██▉       | 236/810 [06:39<16:22,  1.71s/it] 29%|██▉       | 237/810 [06:41<16:07,  1.69s/it] 29%|██▉       | 238/810 [06:42<16:26,  1.72s/it] 30%|██▉       | 239/810 [06:44<16:08,  1.70s/it] 30%|██▉       | 240/810 [06:46<15:55,  1.68s/it] 30%|██▉       | 241/810 [06:48<16:16,  1.72s/it] 30%|██▉       | 242/810 [06:49<16:01,  1.69s/it] 30%|███       | 243/810 [06:51<15:06,  1.60s/it]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:276: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/loky-53042-uo1t6k38'}
  warnings.warn(
2025-06-12 18:27:05,401 - TestLogging - INFO - File logging test - INFO message
2025-06-12 18:27:05,401 - TestLogging - WARNING - File logging test - WARNING message
2025-06-12 18:27:05,401 - TestLogging - ERROR - File logging test - ERROR message
2025-06-12 18:29:18,623 - TestLogging - INFO - File logging test - INFO message
2025-06-12 18:29:18,623 - TestLogging - WARNING - File logging test - WARNING message
2025-06-12 18:29:18,623 - TestLogging - ERROR - File logging test - ERROR message
2025-06-12 18:30:26,127 - SailingRulesTrainer - INFO - Logging initialized. Writing to training.log
2025-06-12 18:30:26,914 - SailingRulesTrainer - INFO - Weights & Biases initialized. Project: sailing-rules-assistant, Run: flan-t5-16-epochs-10
2025-06-12 18:30:26,915 - SailingRulesTrainer - INFO - Starting training preparation
2025-06-12 18:30:30,294 - SailingRulesTrainer - INFO - Using device: cpu
2025-06-12 18:30:30,311 - SailingRulesTrainer - WARNING - Warning: fp16 mixed precision is not supported on this device. Training with fp32 instead.
2025-06-12 18:30:30,311 - SailingRulesTrainer - INFO - Validation dataset is empty. Training without validation.
2025-06-12 18:30:30,809 - SailingRulesTrainer - INFO - Starting training with 323 examples for 10 epochs
2025-06-12 18:37:03,448 - SailingRulesTrainer - INFO - Logging initialized. Writing to training.log
2025-06-12 18:37:04,213 - SailingRulesTrainer - INFO - Weights & Biases initialized. Project: sailing-rules-assistant, Run: flan-t5-16-epochs-10
2025-06-12 18:37:04,214 - SailingRulesTrainer - INFO - Starting training preparation
2025-06-12 18:37:07,727 - SailingRulesTrainer - INFO - Using device: cpu
2025-06-12 18:37:07,747 - SailingRulesTrainer - WARNING - Warning: fp16 mixed precision is not supported on this device. Training with fp32 instead.
2025-06-12 18:37:07,748 - SailingRulesTrainer - INFO - Validation dataset is empty. Training without validation.
2025-06-12 18:37:08,216 - SailingRulesTrainer - INFO - Starting training with 323 examples for 10 epochs
2025-06-12 18:59:19,153 - SailingRulesTrainer - INFO - Training completed successfully
2025-06-12 18:59:19,156 - SailingRulesTrainer - INFO - Saving model to models/sailing_rules_assistant
2025-06-12 19:00:06,839 - SailingRulesTrainer - INFO - Training complete. Model saved to models/sailing_rules_assistant
2025-06-12 20:17:43,384 - SailingRulesTrainer - INFO - Logging initialized. Writing to training.log
2025-06-12 20:17:45,261 - SailingRulesTrainer - INFO - Weights & Biases initialized. Project: sailing-rules-assistant, Run: flan-t5-32-epochs-15
2025-06-12 20:17:45,261 - SailingRulesTrainer - INFO - Starting training preparation
2025-06-12 20:17:57,288 - SailingRulesTrainer - INFO - Using device: cpu
2025-06-12 20:17:57,363 - SailingRulesTrainer - WARNING - Warning: fp16 mixed precision is not supported on this device. Training with fp32 instead.
2025-06-12 20:17:57,364 - SailingRulesTrainer - INFO - Validation dataset is empty. Training without validation.
2025-06-12 20:18:00,900 - SailingRulesTrainer - INFO - Starting training with 323 examples for 15 epochs
