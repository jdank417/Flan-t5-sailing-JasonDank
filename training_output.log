nohup: ignoring input
2025-06-12 18:30:26,127 - SailingRulesTrainer - INFO - Logging initialized. Writing to training.log
wandb: Currently logged in as: dankj (dankj-jason-dank) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /Users/jasondank/PycharmProjects/Flan-t5-sailing/wandb/run-20250612_183026-j5tlpvqy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run flan-t5-16-epochs-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/dankj-jason-dank/sailing-rules-assistant
wandb: üöÄ View run at https://wandb.ai/dankj-jason-dank/sailing-rules-assistant/runs/j5tlpvqy
2025-06-12 18:30:26,914 - SailingRulesTrainer - INFO - Weights & Biases initialized. Project: sailing-rules-assistant, Run: flan-t5-16-epochs-10
wandb: WARNING The get_url method is deprecated and will be removed in a future release. Please use `run.url` instead.
2025-06-12 18:30:26,915 - SailingRulesTrainer - INFO - Starting training preparation
Loading processed dataset...
Initializing model...
Trainable parameters: 1,769,472 (0.71% of 249,347,328 total)
Starting training...
Weights & Biases initialized. Project: sailing-rules-assistant, Run: flan-t5-16-epochs-10
Track your training at: https://wandb.ai/dankj-jason-dank/sailing-rules-assistant/runs/j5tlpvqy
Map:   0%|          | 0/323 [00:00<?, ? examples/s]/Users/jasondank/PycharmProjects/Flan-t5-sailing/.venv/lib/python3.13/site-packages/transformers/tokenization_utils_base.py:3959: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 323/323 [00:00<00:00, 8901.53 examples/s]
2025-06-12 18:30:30,294 - SailingRulesTrainer - INFO - Using device: cpu
2025-06-12 18:30:30,311 - SailingRulesTrainer - WARNING - Warning: fp16 mixed precision is not supported on this device. Training with fp32 instead.
2025-06-12 18:30:30,311 - SailingRulesTrainer - INFO - Validation dataset is empty. Training without validation.
/Users/jasondank/PycharmProjects/Flan-t5-sailing/models/trainer.py:240: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
  trainer = Seq2SeqTrainer(**trainer_kwargs)
You are adding a <class 'transformers.integrations.integration_utils.WandbCallback'> to the callbacks of this Trainer, but there is already one. The currentlist of callbacks is
:DefaultFlowCallback
WandbCallback
No label_names provided for model class `PeftModelForSeq2SeqLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
2025-06-12 18:30:30,809 - SailingRulesTrainer - INFO - Starting training with 323 examples for 10 epochs
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.

==================================================
TRAINING STARTED
==================================================
Training logs are being saved to: training.log
Track training progress in real-time at: https://wandb.ai/dankj-jason-dank/sailing-rules-assistant/runs/j5tlpvqy
You can safely close this terminal - training will continue in the background.
==================================================

  0%|          | 0/810 [00:00<?, ?it/s]/Users/jasondank/PycharmProjects/Flan-t5-sailing/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.48.0. You should pass an instance of `EncoderDecoderCache` instead, e.g. `past_key_values=EncoderDecoderCache.from_legacy_cache(past_key_values)`.
  0%|          | 1/810 [00:02<29:15,  2.17s/it]  0%|          | 2/810 [00:03<23:57,  1.78s/it]  0%|          | 3/810 [00:05<21:50,  1.62s/it]  0%|          | 4/810 [00:06<20:41,  1.54s/it]  1%|          | 5/810 [00:07<20:11,  1.51s/it]  1%|          | 6/810 [00:09<20:05,  1.50s/it]  1%|          | 7/810 [00:10<19:43,  1.47s/it]  1%|          | 8/810 [00:12<19:37,  1.47s/it]  1%|          | 9/810 [00:13<19:29,  1.46s/it]  1%|          | 10/810 [00:15<19:23,  1.45s/it]                                                  1%|          | 10/810 [00:15<19:23,  1.45s/it]  1%|‚ñè         | 11/810 [00:16<20:19,  1.53s/it]  1%|‚ñè         | 12/810 [00:18<21:34,  1.62s/it]  2%|‚ñè         | 13/810 [00:20<21:02,  1.58s/it]  2%|‚ñè         | 14/810 [00:22<21:58,  1.66s/it]  2%|‚ñè         | 15/810 [00:23<21:21,  1.61s/it]  2%|‚ñè         | 16/810 [00:25<20:42,  1.56s/it]  2%|‚ñè         | 17/810 [00:26<20:10,  1.53s/it]  2%|‚ñè         | 18/810 [00:27<19:46,  1.50s/it]  2%|‚ñè         | 19/810 [00:29<19:31,  1.48s/it]  2%|‚ñè         | 20/810 [00:30<19:19,  1.47s/it]                                                  2%|‚ñè         | 20/810 [00:30<19:19,  1.47s/it]  3%|‚ñé         | 21/810 [00:32<19:12,  1.46s/it]  3%|‚ñé         | 22/810 [00:33<19:06,  1.45s/it]  3%|‚ñé         | 23/810 [00:35<19:24,  1.48s/it]  3%|‚ñé         | 24/810 [00:36<19:12,  1.47s/it]  3%|‚ñé         | 25/810 [00:38<18:59,  1.45s/it]  3%|‚ñé         | 26/810 [00:39<18:50,  1.44s/it]  3%|‚ñé         | 27/810 [00:40<18:51,  1.44s/it]  3%|‚ñé         | 28/810 [00:42<18:49,  1.44s/it]  4%|‚ñé         | 29/810 [00:43<19:10,  1.47s/it]  4%|‚ñé         | 30/810 [00:45<18:59,  1.46s/it]                                                  4%|‚ñé         | 30/810 [00:45<18:59,  1.46s/it]  4%|‚ñç         | 31/810 [00:46<18:53,  1.45s/it]  4%|‚ñç         | 32/810 [00:48<18:40,  1.44s/it]  4%|‚ñç         | 33/810 [00:49<18:36,  1.44s/it]  4%|‚ñç         | 34/810 [00:51<18:34,  1.44s/it]  4%|‚ñç         | 35/810 [00:52<18:39,  1.44s/it]  4%|‚ñç         | 36/810 [00:53<18:37,  1.44s/it]  5%|‚ñç         | 37/810 [00:55<18:34,  1.44s/it]  5%|‚ñç         | 38/810 [00:56<18:32,  1.44s/it]  5%|‚ñç         | 39/810 [00:58<18:38,  1.45s/it]  5%|‚ñç         | 40/810 [00:59<18:42,  1.46s/it]                                                  5%|‚ñç         | 40/810 [00:59<18:42,  1.46s/it]  5%|‚ñå         | 41/810 [01:01<18:37,  1.45s/it]  5%|‚ñå         | 42/810 [01:02<18:29,  1.44s/it]  5%|‚ñå         | 43/810 [01:04<18:33,  1.45s/it]  5%|‚ñå         | 44/810 [01:05<18:44,  1.47s/it]  6%|‚ñå         | 45/810 [01:07<18:36,  1.46s/it]  6%|‚ñå         | 46/810 [01:08<18:40,  1.47s/it]  6%|‚ñå         | 47/810 [01:10<18:45,  1.48s/it]  6%|‚ñå         | 48/810 [01:11<18:39,  1.47s/it]  6%|‚ñå         | 49/810 [01:12<18:31,  1.46s/it]  6%|‚ñå         | 50/810 [01:14<18:24,  1.45s/it]                                                  6%|‚ñå         | 50/810 [01:14<18:24,  1.45s/it]  6%|‚ñã         | 51/810 [01:15<18:18,  1.45s/it]  6%|‚ñã         | 52/810 [01:17<18:15,  1.44s/it]  7%|‚ñã         | 53/810 [01:18<18:11,  1.44s/it]  7%|‚ñã         | 54/810 [01:20<18:08,  1.44s/it]  7%|‚ñã         | 55/810 [01:21<18:08,  1.44s/it]  7%|‚ñã         | 56/810 [01:23<18:07,  1.44s/it]  7%|‚ñã         | 57/810 [01:24<18:03,  1.44s/it]  7%|‚ñã         | 58/810 [01:25<18:00,  1.44s/it]  7%|‚ñã         | 59/810 [01:27<17:59,  1.44s/it]  7%|‚ñã         | 60/810 [01:28<17:57,  1.44s/it]                                                  7%|‚ñã         | 60/810 [01:28<17:57,  1.44s/it]  8%|‚ñä         | 61/810 [01:30<17:59,  1.44s/it]  8%|‚ñä         | 62/810 [01:31<17:56,  1.44s/it]  8%|‚ñä         | 63/810 [01:33<17:53,  1.44s/it]  8%|‚ñä         | 64/810 [01:34<17:51,  1.44s/it]  8%|‚ñä         | 65/810 [01:35<17:54,  1.44s/it]  8%|‚ñä         | 66/810 [01:37<17:52,  1.44s/it]  8%|‚ñä         | 67/810 [01:38<17:48,  1.44s/it]  8%|‚ñä         | 68/810 [01:40<17:45,  1.44s/it]  9%|‚ñä         | 69/810 [01:41<17:44,  1.44s/it]  9%|‚ñä         | 70/810 [01:43<17:42,  1.44s/it]                                                  9%|‚ñä         | 70/810 [01:43<17:42,  1.44s/it]  9%|‚ñâ         | 71/810 [01:44<17:41,  1.44s/it]  9%|‚ñâ         | 72/810 [01:46<17:39,  1.44s/it]  9%|‚ñâ         | 73/810 [01:47<17:38,  1.44s/it]  9%|‚ñâ         | 74/810 [01:48<17:36,  1.44s/it]  9%|‚ñâ         | 75/810 [01:50<17:35,  1.44s/it]  9%|‚ñâ         | 76/810 [01:51<17:39,  1.44s/it] 10%|‚ñâ         | 77/810 [01:53<17:37,  1.44s/it] 10%|‚ñâ         | 78/810 [01:54<17:38,  1.45s/it] 10%|‚ñâ         | 79/810 [01:56<17:34,  1.44s/it] 10%|‚ñâ         | 80/810 [01:57<17:32,  1.44s/it]                                                 10%|‚ñâ         | 80/810 [01:57<17:32,  1.44s/it] 10%|‚ñà         | 81/810 [01:58<16:31,  1.36s/it] 10%|‚ñà         | 82/810 [02:00<16:47,  1.38s/it] 10%|‚ñà         | 83/810 [02:01<16:55,  1.40s/it] 10%|‚ñà         | 84/810 [02:03<17:01,  1.41s/it] 10%|‚ñà         | 85/810 [02:04<17:05,  1.42s/it] 11%|‚ñà         | 86/810 [02:05<17:08,  1.42s/it] 11%|‚ñà         | 87/810 [02:07<17:10,  1.42s/it] 11%|‚ñà         | 88/810 [02:08<17:12,  1.43s/it] 11%|‚ñà         | 89/810 [02:10<17:12,  1.43s/it] 11%|‚ñà         | 90/810 [02:11<17:11,  1.43s/it]                                                 11%|‚ñà         | 90/810 [02:11<17:11,  1.43s/it] 11%|‚ñà         | 91/810 [02:13<17:11,  1.43s/it] 11%|‚ñà‚ñè        | 92/810 [02:14<17:10,  1.43s/it] 11%|‚ñà‚ñè        | 93/810 [02:15<17:10,  1.44s/it] 12%|‚ñà‚ñè        | 94/810 [02:17<17:09,  1.44s/it] 12%|‚ñà‚ñè        | 95/810 [02:18<17:08,  1.44s/it] 12%|‚ñà‚ñè        | 96/810 [02:20<17:06,  1.44s/it] 12%|‚ñà‚ñè        | 97/810 [02:21<17:07,  1.44s/it] 12%|‚ñà‚ñè        | 98/810 [02:23<17:06,  1.44s/it] 12%|‚ñà‚ñè        | 99/810 [02:24<17:03,  1.44s/it] 12%|‚ñà‚ñè        | 100/810 [02:26<17:00,  1.44s/it]                                                  12%|‚ñà‚ñè        | 100/810 [02:26<17:00,  1.44s/it] 12%|‚ñà‚ñè        | 101/810 [02:27<16:59,  1.44s/it] 13%|‚ñà‚ñé        | 102/810 [02:28<16:56,  1.44s/it] 13%|‚ñà‚ñé        | 103/810 [02:30<16:55,  1.44s/it] 13%|‚ñà‚ñé        | 104/810 [02:31<16:53,  1.44s/it] 13%|‚ñà‚ñé        | 105/810 [02:33<16:51,  1.43s/it] 13%|‚ñà‚ñé        | 106/810 [02:34<17:00,  1.45s/it] 13%|‚ñà‚ñé        | 107/810 [02:36<16:58,  1.45s/it] 13%|‚ñà‚ñé        | 108/810 [02:37<16:54,  1.44s/it] 13%|‚ñà‚ñé        | 109/810 [02:38<16:53,  1.45s/it] 14%|‚ñà‚ñé        | 110/810 [02:40<16:51,  1.44s/it]                                                  14%|‚ñà‚ñé        | 110/810 [02:40<16:51,  1.44s/it] 14%|‚ñà‚ñé        | 111/810 [02:41<16:48,  1.44s/it] 14%|‚ñà‚ñç        | 112/810 [02:43<16:45,  1.44s/it] 14%|‚ñà‚ñç        | 113/810 [02:44<16:43,  1.44s/it] 14%|‚ñà‚ñç        | 114/810 [02:46<16:38,  1.44s/it] 14%|‚ñà‚ñç        | 115/810 [02:47<16:43,  1.44s/it] 14%|‚ñà‚ñç        | 116/810 [02:49<16:46,  1.45s/it] 14%|‚ñà‚ñç        | 117/810 [02:50<16:37,  1.44s/it] 15%|‚ñà‚ñç        | 118/810 [02:52<17:12,  1.49s/it] 15%|‚ñà‚ñç        | 119/810 [02:53<16:53,  1.47s/it] 15%|‚ñà‚ñç        | 120/810 [02:54<16:44,  1.46s/it]                                                  15%|‚ñà‚ñç        | 120/810 [02:54<16:44,  1.46s/it] 15%|‚ñà‚ñç        | 121/810 [02:56<16:37,  1.45s/it] 15%|‚ñà‚ñå        | 122/810 [02:57<16:57,  1.48s/it] 15%|‚ñà‚ñå        | 123/810 [02:59<16:47,  1.47s/it] 15%|‚ñà‚ñå        | 124/810 [03:00<16:41,  1.46s/it] 15%|‚ñà‚ñå        | 125/810 [03:02<16:41,  1.46s/it] 16%|‚ñà‚ñå        | 126/810 [03:03<16:38,  1.46s/it] 16%|‚ñà‚ñå        | 127/810 [03:05<16:33,  1.46s/it] 16%|‚ñà‚ñå        | 128/810 [03:06<16:35,  1.46s/it] 16%|‚ñà‚ñå        | 129/810 [03:08<16:35,  1.46s/it] 16%|‚ñà‚ñå        | 130/810 [03:09<16:32,  1.46s/it]                                                  16%|‚ñà‚ñå        | 130/810 [03:09<16:32,  1.46s/it] 16%|‚ñà‚ñå        | 131/810 [03:11<16:30,  1.46s/it] 16%|‚ñà‚ñã        | 132/810 [03:12<16:31,  1.46s/it]/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:276: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/loky-53788-92gnz709'}
  warnings.warn(
